<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradingView Chart</title>
    <style>
        body,
        html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
            background-color: #0F0F0F;
            /* Match widget background */
        }

        .tradingview-widget-container {
            height: 100%;
            width: 100%;
        }
    </style>
</head>

<body>
    <!-- TradingView Widget BEGIN -->
    <div class="tradingview-widget-container" style="height:100%;width:100%">
        <div class="tradingview-widget-container__widget" style="height:calc(100% - 32px);width:100%"></div>
        <div class="tradingview-widget-copyright"><a href="https://www.tradingview.com/" rel="noopener nofollow"
                target="_blank"><span class="blue-text">Track all markets on TradingView</span></a></div>
        <script type="text/javascript"
            src="https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js" async>
                {
                    "autosize": true,
                        "symbol": "NASDAQ:AAPL",
                            "interval": "D",
                                "timezone": "Etc/UTC",
                                    "theme": "dark",
                                        "style": "1",
                                            "locale": "en",
                                                "enable_publishing": false,
                                                    "backgroundColor": "#0F0F0F",
                                                        "gridColor": "rgba(242, 242, 242, 0.06)",
                                                            "allow_symbol_change": true,
                                                                "calendar": false,
                                                                    "details": false,
                                                                        "hide_side_toolbar": true,
                                                                            "hide_top_toolbar": false,
                                                                                "hide_legend": false,
                                                                                    "hide_volume": false,
                                                                                        "hotlist": false,
                                                                                            "save_image": true,
                                                                                                "watchlist": [],
                                                                                                    "withdateranges": false,
                                                                                                        "compareSymbols": [],
                                                                                                            "studies": [
                                                                                                                "STD;RSI"
                                                                                                            ]
                }
            </script>
    </div>
    <!-- TradingView Widget END -->

    <script>
        // Function to get query parameter by name
        function getParameterByName(name, url = window.location.href) {
            name = name.replace(/[\[\]]/g, '\\$&');
            var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, ' '));
        }

        // Get symbol from URL parameter, default to AAPL if not present
        const symbol = getParameterByName('symbol') || 'NASDAQ:AAPL';

        // Update the widget configuration dynamically

        // Clear existing content to prevent duplication
        const container = document.querySelector('.tradingview-widget-container');
        container.innerHTML = '<div class="tradingview-widget-container__widget" style="height:calc(100% - 32px);width:100%"></div><div class="tradingview-widget-copyright"><a href="https://www.tradingview.com/" rel="noopener nofollow" target="_blank"><span class="blue-text">Track all markets on TradingView</span></a></div>';

        const script = document.createElement('script');
        script.type = 'text/javascript';
        script.src = 'https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js';
        script.async = true;
        script.innerHTML = JSON.stringify({
            "autosize": true,
            "symbol": symbol,
            "interval": "D",
            "timezone": "Etc/UTC",
            "theme": "dark",
            "style": "1",
            "locale": "ru",
            "enable_publishing": false,
            "backgroundColor": "#0F0F0F",
            "gridColor": "rgba(242, 242, 242, 0.06)",
            "allow_symbol_change": true,
            "calendar": false,
            "details": false,
            "hide_side_toolbar": true,
            "hide_top_toolbar": false,
            "hide_legend": false,
            "hide_volume": false,
            "hotlist": false,
            "save_image": true,
            "watchlist": [],
            "withdateranges": false,
            "compareSymbols": [],
            "studies": [
                "STD;RSI"
            ]
        });

        container.appendChild(script);
    </script>
</body>

</html>
